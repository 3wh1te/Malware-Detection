import angr
from archinfo import ArchAMD64
from io import BytesIO, IOBase
import chardet
arch = ArchAMD64()

with open('../sample/0akIgwhWHYm1dzsNqBFx.asm', 'r', encoding='KOI8-R') as rf:
    asm = rf.read()
# print(chardet.detect(asm))
p = angr.project.load_shellcode(asm, arch=arch)

print('Done')
cfg = p.analyses.CFGFast()
print('Done')

for block in cfg:
    print(block)

