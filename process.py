import glob
import re
from sklearn.feature_extraction.text import *

def load_files_from_dir(dir):
    files = glob.glob(dir)
    result = []
    for file in files:
        with open(file) as f:
            lines = f.readlines()
            lines_to_line = " ".join(lines)
            lines_to_line = re.sub(r"[APT|Crypto|Locker|Zeus]", ' ', lines_to_line, flags=re.I)
            result.append(lines_to_line)
    return result

def loadFiles(dir):
    malware_class = ['APT', 'Crypto', 'Locker', 'Zeus']
    x = []
    y = []
    for i, family in enumerate(malware_class):
        dir = "../data/malware/MalwareTrainingSets-master/trainingSets/%s/*" % family
        print("Load files from %s" % dir)
        v = load_files_from_dir(dir)
        x += v
        y += [i] * len(v)
    return x, y

counter = CountVectorizer()
if __name__ == '__main__':
    print(readFiles('.data/'))